CREATE OR REPLACE PROCEDURE PA_GUARDAR_PRODUCTO(DESCRIPCION VARCHAR2, FECHA_VENCIMIENTO DATE, STOCK NUMBER, STOCK_CRITICO NUMBER,

PRECIO NUMBER,FOTO BLOB, COD_PROVEEDOR NUMBER, COD_FAMILIA NUMBER, COD_TIPO_PRODUCTO NUMBER, SALIDA OUT SYS_REFCURSOR)

IS

  SALIDA NUMBER;

  COD_PRODUCTO NUMBER;

BEGIN

  IF FECHA_VENCIMIENTO IS NULL THEN

    SALIDA :=1;

    DBMS_OUTPUT.PUT_LINE(DESCRIPCION|| ' BIEN Y SALIDA ES: '||SALIDA);

    DBMS_OUTPUT.PUT_LINE('EL CODIGO DEL PRODUCTO ES: '||COD_PROVEEDOR||''||COD_FAMILIA||''||'00000000'||''||COD_TIPO_PRODUCTO);

    COD_PRODUCTO := TO_NUMBER(COD_PROVEEDOR||''||COD_FAMILIA||''||'00000000'||''||COD_TIPO_PRODUCTO);

    INSERT INTO PRODUCTO VALUES 

      (COD_PRODUCTO,DESCRIPCION,FECHA_VENCIMIENTO, STOCK, STOCK_CRITICO, PRECIO, FOTO, COD_PROVEEDOR, COD_FAMILIA, COD_TIPO_PRODUCTO);

  END IF;

  IF FECHA_VENCIMIENTO IS NOT NULL THEN

    SALIDA :=1;

    DBMS_OUTPUT.PUT_LINE(DESCRIPCION|| ' BIEN Y SALIDA ES: '||SALIDA);

    DBMS_OUTPUT.PUT_LINE('EL CODIGO DEL PRODUCTO ES: '||TO_NUMBER(COD_PROVEEDOR||''||COD_FAMILIA||''||TO_NUMBER(TO_CHAR(FECHA_VENCIMIENTO,'DDMMYYYY'))||''||COD_TIPO_PRODUCTO));

    COD_PRODUCTO := TO_NUMBER(COD_PROVEEDOR||''||COD_FAMILIA||''||TO_NUMBER(TO_CHAR(FECHA_VENCIMIENTO,'DDMMYYYY'))||''||COD_TIPO_PRODUCTO);

    INSERT INTO PRODUCTO VALUES 

      (COD_PRODUCTO,DESCRIPCION,FECHA_VENCIMIENTO, STOCK, STOCK_CRITICO, PRECIO, FOTO, COD_PROVEEDOR, COD_FAMILIA, COD_TIPO_PRODUCTO);

  END IF;

   

  EXCEPTION

    WHEN OTHERS THEN

    SALIDA:=0;

      DBMS_OUTPUT.PUT_LINE('ERROR NUMERO: '||SQLCODE);

END PA_GUARDAR_PRODUCTO;

